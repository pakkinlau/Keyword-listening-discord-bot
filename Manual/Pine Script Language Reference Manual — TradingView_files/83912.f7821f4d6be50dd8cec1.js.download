"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[83912],{371856:(e,t,i)=>{i.d(t,{japaneseChartStyles:()=>n,commonChartStyles:()=>a,allChartStyles:()=>o});var r=i(125226),s=i(611688);function n(){const e=[8];return s.enabled("japanese_chart_styles")&&(e.push(4,7,5,6),e.push(11)),e}function a(){const e=[0,1,9,2,3,10];return(0,r.isFeatureEnabled)("chart_style_hilo")&&e.push(12),e}function o(){return a().concat(n())}},701336:(e,t,i)=>{i.d(t,{NumericFormatter:()=>n});var r=i(689765),s=i(960521);class n{constructor(e){this._precision=e}format(e){return(void 0!==this._precision?e.toFixed(this._precision):n.formatNoE(e)).replace(".",r.formatterOptions.decimalSign)}parse(e){const t=e.replace(r.formatterOptions.decimalSign,".");let i=parseFloat(t);return this._precision&&(i=+i.toFixed(this._precision)),i}static formatNoE(e){if(!Number.isFinite(e))return String(e);const t=new s.Big(e);return t.lt(1)?t.toFixed():t.toString()}}},965513:(e,t,i)=>{i.d(t,{PercentageFormatter:()=>n});var r=i(689765),s=i(143498);class n extends r.PriceFormatter{constructor(e){super(e),this.type="percentage"}state(){const e=r.PriceFormatter.prototype.state.call(this);return e.percent=!0,e}parse(e){return e=e.replace("%",""),super.parse(e)}format(e,t,i,r,n=!0){const a=super.format(e,t,i,r,!1)+"%";return n?(0,s.forceLTRStr)(a):a}static serialize(e){return e.state()}static deserialize(e){return new n(e.priceScale)}}},689765:(e,t,i)=>{i.d(t,{formatterOptions:()=>l,numberToStringWithLeadingZero:()=>c,isFormatterHasForexAdditionalPrecision:()=>h,PriceFormatter:()=>u});var r=i(787236),s=i(270617),n=i(143498);const a=(0,i(911905).getLogger)("Chart.PriceFormatter"),o=new RegExp(/^(-?)[0-9]+$/),l={decimalSign:".",decimalSignFractional:"'"};function c(e,t){if(!(0,s.isNumber)(e))return"n/a";if(!(0,s.isInteger)(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");if(0===t)return e.toString();return("0000000000000000"+e.toString()).slice(-t)}function h(e){return"hasForexAdditionalPrecision"in e}class u{constructor(e,t,i,n){if(this.type="price",this._formatterErrors={custom:(0,r.t)("Price format is invalid."),fraction:(0,r.t)("Fraction part is invalid."),secondFraction:(0,r.t)("Second fraction part is invalid.")},t||(t=1),(0,s.isNumber)(e)&&(0,s.isInteger)(e)||(e=100),e<0)throw new TypeError("invalid base");this._priceScale=e,this._minMove=t,this._minMove2=n,i&&void 0!==n&&n>0&&2!==n&&4!==n&&8!==n?a.logDebug("invalid minmove2"):(this._fractional=i,this.calculateDecimal())}isFractional(){return!!this._fractional}state(){return{fractional:this._fractional,fractionalLength:this._fractionalLength,minMove:this._minMove,minMove2:this._minMove2,priceScale:this._priceScale}}calculateDecimal(){if(this._fractionalLength=0,this._priceScale>0&&this._minMove>0){let e=this._priceScale;for(this._fractional&&this._minMove2&&(e/=this._minMove2);e>1;)e/=10,this._fractionalLength++}}format(e,t,i,r=!0,s=!0){let a,o="";return e<0?(o=!1===r?"":"−",e=-e):e&&!0===t&&(o="+"),
a=this._fractional?o+this._formatAsFractional(e,i):o+this._formatAsDecimal(e,i),s?(0,n.forceLTRStr)(a):a}parse(e){return e=(e=(0,n.stripLTRMarks)(e)).replace("−","-"),this._fractional?this._minMove2?this._parseAsDoubleFractional(e):this._parseAsSingleFractional(e):this._parseAsDecimal(e)}hasForexAdditionalPrecision(){return!this._fractional&&10===this._minMove2}static serialize(e){return e.state()}static deserialize(e){return new u(e.priceScale,e.minMove,e.fractional,e.minMove2)}_formatAsDecimal(e,t){let i;t=t||0,i=this._fractional?Math.pow(10,this._fractionalLength||0):Math.pow(10,t)*this._priceScale/this._minMove;const r=1/i;let s;if(i>1)s=Math.floor(e);else{const t=Math.floor(Math.round(e/r)*r);s=0===Math.round((e-t)/r)?t:t+r}let n="";if(i>1){let r=parseFloat((Math.round(e*i)-s*i).toFixed(this._fractionalLength));r>=i&&(r-=i,s+=1);const a=void 0!==this._fractionalLength?this._fractionalLength:NaN;n=l.decimalSign+c(parseFloat(r.toFixed(this._fractionalLength))*this._minMove,a+t),n=this._removeEndingZeros(n,t)}return s.toString()+n}_getFractPart(e,t,i){const r=[0,5],s=[0,2,5,7],n=[0,1,2,3,5,6,7,8];return 2===i?void 0===r[e]?-1:r[e]:4===i?void 0===s[e]?-1:s[e]:8===i&&2===t?void 0===n[e]?-1:n[e]:e}_formatAsFractional(e,t){const i=this._priceScale/this._minMove;let r=Math.floor(e),s=t?Math.floor(e*i)-r*i:Math.round(e*i)-r*i;s===i&&(s=0,r+=1);let n="";if(t){let a=(e-r-s/i)*i;a=Math.round(a*Math.pow(10,t)),n=c(a,t),n=this._removeEndingZeros(n,t)}if(!this._fractionalLength)throw new Error("_fractionalLength is not calculated");let a="";if(this._minMove2){const e=s%this._minMove2;s=(s-e)/this._minMove2;const t=c(s,this._fractionalLength),i=this._getFractPart(e,2,this._minMove2);a=t+l.decimalSignFractional+i}else s=this._getFractPart(s,1,this._priceScale),a=c(s*this._minMove,this._fractionalLength);return r.toString()+l.decimalSignFractional+a+n}_removeEndingZeros(e,t){for(let i=0;i<t&&"0"===e[e.length-1];i++)e=e.substring(0,e.length-1);return e}_parseAsDecimal(e){let t=o.exec(e);if(t){const t=parseFloat(e);return{value:t,res:!0,suggest:this.format(t)}}if(t=new RegExp("^(-?)[0-9]+\\"+l.decimalSign+"[0-9]*$").exec(e),t){const t=parseFloat(e.replace(l.decimalSign,"."));return{value:t,res:!0,suggest:this.format(t)}}return{error:this._formatterErrors.custom,res:!1}}_patchFractPart(e,t,i){const r={0:0,5:1},s={0:0,2:1,5:2,7:3},n={0:0,1:1,2:2,3:3,5:4,6:5,7:6,8:7};return 2===i?void 0===r[e]?-1:r[e]:4===i?void 0===s[e]?-1:s[e]:8===i&&2===t?void 0===n[e]?-1:n[e]:e}_parseAsSingleFractional(e){let t=o.exec(e);if(t){const t=parseFloat(e);return{value:t,res:!0,suggest:this.format(t)}}if(t=new RegExp("^(-?)([0-9]+)\\"+l.decimalSignFractional+"([0-9]+)$").exec(e),t){const e=!!t[1],i=parseInt(t[2]),r=this._priceScale,s=this._patchFractPart(parseInt(t[3]),1,r);if(s>=r||s<0)return{error:this._formatterErrors.fraction,res:!1};let n=i+s/r;return e&&(n=-n),{value:n,res:!0,suggest:this.format(n)}}return{error:this._formatterErrors.custom,res:!1}}_parseAsDoubleFractional(e){let t=o.exec(e);if(t){const t=parseFloat(e);return{value:t,res:!0,
suggest:this.format(t)}}if(t=new RegExp("^(-?)([0-9]+)\\"+l.decimalSignFractional+"([0-9]+)\\"+l.decimalSignFractional+"([0-9]+)$").exec(e),t){const e=!!t[1],i=parseInt(t[2]),r=void 0!==this._minMove2?this._minMove2:NaN,s=this._priceScale/r,n=this._minMove2,a=this._patchFractPart(parseInt(t[3]),1,s),o=this._patchFractPart(parseInt(t[4]),2,n);if(a>=s||a<0)return{error:this._formatterErrors.fraction,res:!1};if(void 0!==n&&o>=n||o<0)return{error:this._formatterErrors.secondFraction,res:!1};let l=void 0!==n?i+a/s+o/(s*n):NaN;return e&&(l=-l),{value:l,res:!0,suggest:this.format(l)}}return{error:this._formatterErrors.custom,res:!1}}}},591419:(e,t,i)=>{i.d(t,{PLACE_HOLDER:()=>o,NOT_AVAILABLE_VOLUME_FORMATTER:()=>l,VolumeFormatter:()=>c});var r=i(787236),s=i(701336),n=i(270617),a=i(793751);const o="---",l=1e100;class c{constructor(e){this.type="volume",this._numericFormatter=new s.NumericFormatter,this._fractionalValues=void 0!==e&&e>0,this._precision=e}state(){return{precision:this._precision}}format(e,t){if(!(0,n.isNumber)(e))return o;let i="";return e<0?(i="−",e=-e):e>0&&t&&(i="+"),e>=l?(0,r.t)("N/A"):(!this._fractionalValues||e>=995?e=Math.round(e):this._fractionalValues&&(e=+e.toFixed(this._precision)),e<995?i+this._formatNumber(e):e<999995?i+this._formatNumber(e/1e3)+"K":e<999999995?(e=1e3*Math.round(e/1e3),i+this._formatNumber(e/1e6)+"M"):e<999999999995?(e=1e6*Math.round(e/1e6),i+this._formatNumber(e/1e9)+"B"):(e=1e9*Math.round(e/1e9),i+this._formatNumber(e/1e12)+"T"))}parse(e){if("---"===e)return{error:"not a number",res:!1,value:NaN};const t={K:1e3,M:1e6,B:1e9},i=e.slice(-1);if(t.hasOwnProperty(i)){const r=this._numericFormatter.parse(e.slice(0,-1));return(0,n.isNumber)(r)?{res:!0,value:r*t[i]}:{error:"not a number",res:!1,value:NaN}}{const t=this._numericFormatter.parse(e);return(0,n.isNumber)(t)?{res:!0,value:t}:{error:"not a number",res:!1,value:NaN}}}static serialize(e){return e.state()}static deserialize(e){return new c(e.precision)}_formatNumber(e){return this._fractionalValues&&(e=(0,a.fixComputationError)(e)),this._numericFormatter.format(e).replace(/(\.[1-9]*)0+$/,(e,t)=>t)}}},273044:(e,t,i)=>{i.r(t),i.d(t,{ResolutionKind:()=>n,SpecialResolutionKind:()=>a,Interval:()=>h,isHour:()=>d});const r=/^(\d*)([TSHDWMR])$/,s=/^(\d+)$/;var n,a;!function(e){e.Ticks="ticks",e.Seconds="seconds",e.Minutes="minutes",e.Days="days",e.Weeks="weeks",e.Months="months",e.Range="range",e.Invalid="invalid"}(n||(n={})),function(e){e.Hours="hours"}(a||(a={}));const o={};o[n.Ticks]=1e3,o[n.Seconds]=1e3,o[n.Minutes]=60*o[n.Seconds],o[n.Days]=1440*o[n.Minutes],o[n.Weeks]=7*o[n.Days];const l={T:n.Ticks,S:n.Seconds,D:n.Days,W:n.Weeks,M:n.Months,R:n.Range},c=new Set([n.Ticks,n.Seconds,n.Minutes]);class h{constructor(e,t){this._kind=n.Invalid,this._multiplier=0,e!==n.Invalid&&t>0&&(this._kind=e,this._multiplier=t)}kind(){return this._kind}multiplier(){return this._multiplier}isValid(){return this.kind()!==n.Invalid&&this.multiplier()>0}isDWM(){return this.isValid()&&!this.isRange()&&!this.isIntraday()&&!this.isTicks()}isIntraday(){
const e=c.has(this.kind());return this.isValid()&&e}isSeconds(){return this.kind()===n.Seconds}isMinutes(){return this.kind()===n.Minutes}isMinuteHours(){return this.kind()===n.Minutes&&d(this.multiplier())}isDays(){return this.kind()===n.Days}isWeeks(){return this.kind()===n.Weeks}isMonths(){return this.kind()===n.Months}isRange(){return this.kind()===n.Range}isTicks(){return this.kind()===n.Ticks}isTimeBased(){return!this.isRange()}letter(){return this.isValid()&&this.kind()!==n.Minutes?this.kind()[0].toUpperCase():""}value(){return this.isValid()?this.kind()===n.Minutes?this.multiplier()+"":this.multiplier()+this.letter():""}isEqualTo(e){if(!(e instanceof h))throw new Error("Argument is not an Interval");return!(!this.isValid()||!e.isValid())&&(this.kind()===e.kind()&&this.multiplier()===e.multiplier())}inMilliseconds(e=Date.now()){if(!this.isValid()||this.isRange())return NaN;if(this.isMonths()){const t=new Date(e);t.setUTCMonth(t.getUTCMonth()+(this.multiplier()||1));return+t-e}const t=this.multiplier();return o[this.kind()]*t}static isEqual(e,t){return e===t||h.parse(e).isEqualTo(h.parse(t))}static parseExt(e){e=(e+"").toUpperCase().split(",")[0];let t=r.exec(e);return null!==t?"H"===t[2]?{interval:new h(n.Minutes,60*u(t[1])),guiResolutionKind:a.Hours}:{interval:new h(l[t[2]],u(t[1])),guiResolutionKind:l[t[2]]}:(t=s.exec(e),null!==t?{interval:new h(n.Minutes,u(t[1])),guiResolutionKind:n.Minutes}:{interval:new h(n.Invalid,0),guiResolutionKind:n.Invalid})}static parse(e){return h.parseExt(e).interval}static kind(e){return h.parse(e).kind()}static isValid(e){return h.parse(e).isValid()}static isDWM(e){return h.parse(e).isDWM()}static isIntraday(e){return h.parse(e).isIntraday()}static isSeconds(e){return h.parse(e).isSeconds()}static isMinutes(e){return h.parse(e).isMinutes()}static isMinuteHours(e){return h.parse(e).isMinuteHours()}static isDays(e){return h.parse(e).isDays()}static isWeeks(e){return h.parse(e).isWeeks()}static isMonths(e){return h.parse(e).isMonths()}static isRange(e){return h.parse(e).isRange()}static isTicks(e){return h.parse(e).isTicks()}static isTimeBased(e){return h.parse(e).isTimeBased()}static normalize(e){const t=h.parse(e);return t.isValid()?t.value():null}}function u(e){return 0===e.length?1:parseInt(e,10)}function d(e){return e>=60&&!(e%60)}},195048:(e,t,i)=>{i.r(t),i.d(t,{STATUS_OFFLINE:()=>r,STATUS_RESOLVING:()=>s,STATUS_LOADING:()=>n,STATUS_READY:()=>a,STATUS_INVALID_SYMBOL:()=>o,STATUS_SNAPSHOT:()=>l,STATUS_EOD:()=>c,STATUS_PULSE:()=>h,STATUS_DELAYED:()=>u,STATUS_DELAYED_STREAMING:()=>d,STATUS_NO_BARS:()=>_,STATUS_REPLAY:()=>m,STATUS_ERROR:()=>S,SERIES_STATUS_TEXT:()=>y,STYLE_LINE_TYPE_MARKERS:()=>b,STYLE_LINE_TYPE_STEP:()=>p,STYLE_LINE_TYPE_SIMPLE:()=>f,STYLE_BARS:()=>g,STYLE_CANDLES:()=>v,STYLE_LINE:()=>w,STYLE_AREA:()=>C,STYLE_RENKO:()=>E,STYLE_KAGI:()=>T,STYLE_PNF:()=>M,STYLE_PB:()=>L,STYLE_HEIKEN_ASHI:()=>I,STYLE_HOLLOW_CANDLES:()=>F,STYLE_BASELINE:()=>B,STYLE_RANGE:()=>k,STYLE_HILO:()=>R,STYLE_SHORT_NAMES:()=>N,SYMBOL_STRING_DATA:()=>A})
;const r=0,s=1,n=2,a=3,o=4,l=5,c=6,h=7,u=8,d=9,_=10,m=11,S=12,y={[r]:"connecting",[s]:"loading",[n]:"loading",[a]:"realtime",[o]:"invalid",[l]:"snapshot",[c]:"endofday",[h]:"endofday",[u]:"delayed",[d]:"delayed_streaming",[_]:"forbidden",[m]:"replay",[S]:"error"},b=0,p=1,f=2,g=0,v=1,w=2,C=3,E=4,T=5,M=6,L=7,I=8,F=9,B=10,k=11,R=12,N={0:"bar",1:"candle",9:"hollowCandle",2:"line",3:"area",4:"renko",7:"pb",5:"kagi",6:"pnf",8:"ha",10:"baseline",11:"range",12:"hilo"},A={4:{type:"BarSetRenko@tv-prostudies",basicStudyVersion:40},7:{type:"BarSetPriceBreak@tv-prostudies",basicStudyVersion:34},5:{type:"BarSetKagi@tv-prostudies",basicStudyVersion:34},6:{type:"BarSetPnF@tv-prostudies",basicStudyVersion:34},8:{type:"BarSetHeikenAshi@tv-basicstudies",basicStudyVersion:60},11:{type:"BarSetRange@tv-basicstudies",basicStudyVersion:72}}},749473:(e,t,i)=>{i.r(t),i.d(t,{isRequiringRestartSeriesStyles:()=>f,isRangeBasedStyle:()=>g,isRangeStyle:()=>v,isTimeBasedStyle:()=>w,isValidStyle:()=>C,isSingleValueBasedStyle:()=>E,setLastUsedStyle:()=>T,getLastUsedStyle:()=>M,getLastUsedSingleValueBasedStyle:()=>L,getDefaultStyle:()=>I,getChartStyleByResolution:()=>F,chartStyleStudyId:()=>B,preparePriceAxisProperties:()=>k,hasProjection:()=>N,isPriceSourceStyle:()=>A,getSeriesPriceFormattingState:()=>V,createSeriesFormatter:()=>P,symbolCurrencyConvertible:()=>D,symbolCurrency:()=>W,symbolOriginalCurrency:()=>x,symbolBaseCurrency:()=>O,isConvertedToOtherCurrency:()=>U,symbolUnitConvertible:()=>Y,symbolUnit:()=>H,symbolOriginalUnit:()=>K,isConvertedToOtherUnit:()=>$,symbolUnitConvertibleGroupsIfExist:()=>G,symbolCurrentContract:()=>z,symbolHasPreOrPostMarket:()=>q,symbolHasSeveralSessions:()=>Z,symbolHasEconomicEvents:()=>j,extractSymbolNameFromSymbolInfo:()=>X,symbolTitle:()=>J,displayedSymbolName:()=>Q,displayedSymbolExchange:()=>ee,actualSymbol:()=>te,proSymbol:()=>ie,symbolForApi:()=>re,isRegularSessionId:()=>se,isCloseBasedSymbol:()=>ne,hasVolume:()=>ae,isEconomicsSymbol:()=>oe});var r=i(62802),s=i(195048),n=i(273044),a=i(689765),o=i(611688),l=i(588537),c=i(591419),h=i(965513);const u=o.enabled("pay_attention_to_ticker_not_symbol"),d=o.enabled("uppercase_instrument_names"),_=o.enabled("charting_library_single_symbol_request"),m=o.enabled("use_ticker_on_symbol_info_update"),S=[4,5,6,7,8],y=[4,5,6,7,11],b=[0,1,9,2,3,10,8],p=[2,10,3];function f(e){return-1!==S.indexOf(e)}function g(e){return-1!==y.indexOf(e)}function v(e){return 11===e}function w(e){return-1!==b.indexOf(e)}function C(e){return g(e)||w(e)}function E(e){switch(e){case 3:case 10:case 2:return!0;default:return!1}}function T(e,t){C(e)&&(11!==e&&r.setValue("chart.lastUsedStyle",e),ne(t)&&E(e)&&r.setValue("chart.lastUsedSingleValueBasedStyle",e))}function M(){const e=r.getInt("chart.lastUsedStyle");return void 0===e?1:e}function L(){const e=r.getInt("chart.lastUsedSingleValueBasedStyle");return void 0===e?2:e}function I(e){return e?11:1}function F(e,t){const i=v(t),r=n.Interval.isRange(e);return!i&&r?I(!0):i&&!r?I(!1):t}function B(e,t){const i=s.SYMBOL_STRING_DATA[e]
;return void 0===i?null:t?`${i.type}-${i.basicStudyVersion}`:i.type}function k(e){const t=e.priceAxisProperties,i=t.lockScale.value(),r=6===e.style.value();(r||i)&&(t.log.setValue(!1),t.percentage.setValue(!1)),t.logDisabled.setValue(!(!r&&!i)),t.percentageDisabled.setValue(!(!r&&!i))}const R=[4,7,5,6];function N(e){return-1!==R.indexOf(e)}function A(e){return p.includes(e)}function V(e,t="default",i=!1){let r,s,n=100,a=1;if("default"===t)null!=e&&(n=e.pricescale,a=e.minmov,r=e.fractional,s=e.minmove2);else{let e=t.split(",");3!==e.length&&(e=["100","1","false"]),n=parseInt(e[0]),a=parseInt(e[1]),r="true"===e[2]}return i&&(a=1),{priceScale:n,minMove:a,fractional:r,minMove2:s}}function P(e,t,i=!1){if("default"===t&&null!=e){if("volume"===e.formatter||"volume"===e.format)return new c.VolumeFormatter(2);if("percent"===e.formatter||"percent"===e.format)return new h.PercentageFormatter(e.pricescale)}const{priceScale:r,minMove:s,fractional:n,minMove2:o}=V(e,t,i);return new a.PriceFormatter(r,s,n,o)}function D(e){return null!==e&&"spread"!==e.type}function W(e,t,i){if(null===e)return null;const r=!t||i?e.currency_id:e.currency_code;return void 0===r||""===r||"pct"===r?null:r}function x(e,t){return(t?e.original_currency_code:e.original_currency_id)||W(e,t)}function O(e){return e.base_currency_id||null}function U(e){return!(null===e||!D(e))&&(void 0!==e.original_currency_id&&e.original_currency_id!==e.currency_id)}function Y(e,t){return t&&null!==e&&"spread"!==e.type}function H(e,t){if(null===e||!t)return null;const i=e.unit_id;return void 0===i||""===i?null:i}function K(e,t){return t?e.original_unit_id||H(e,t):null}function $(e,t){return!(null===e||!Y(e,t))&&(void 0!==e.original_unit_id&&e.original_unit_id!==e.unit_id)}function G(e,t){return null!==e&&Y(e,t)?e.unit_conversion_types||null:[]}function z(e){return"futures"===e.type&&e.front_contract||null}function q(e){return null!==e&&void 0!==e.subsessions&&e.subsessions.some(e=>"premarket"===e.id||"postmarket"===e.id)}function Z(e){return null!==e&&void 0!==e.subsessions&&e.subsessions.filter(e=>!e.private).length>1}function j(e){return null!==e&&("forex"===e.type||"cfd"===e.type||"bitcoin"===e.type||"crypto"===e.type)}function X(e,t){let i=e&&(e.pro_name||e.full_name||e.name);return _&&t?i=t:m&&e&&e.ticker&&(i=e.ticker),d&&i&&(i=i.toUpperCase()),i}function J(e,t,i="exchange"){return t?e.name:`${e.name}, ${e[i]}`}function Q(e){let t=e&&(z(e)||e.name)||"";return t.length>40&&(t=t.substring(0,37)+"..."),t.trim()}function ee(e){const t=e?e.exchange:"";return d?t.toUpperCase():t}function te(e,t){return null!==e?e.full_name:t}function ie(e,t){return null!==e?e.pro_name:t}function re(e,t){return u&&e?(0,l.ensureDefined)(e.ticker):te(e,t)}function se(e){return"regular"===e||"us_regular"===e}function ne(e){return"c"===(null==e?void 0:e.visible_plots_set)}function ae(e){return void 0!==e.visible_plots_set?"ohlcv"===e.visible_plots_set:!e.has_no_volume}function oe(e){return"ECONOMICS"===e.listed_exchange}},583912:(e,t,i)=>{i.d(t,{linking:()=>S})
;var r=i(12481),s=i(262325),n=i.n(s),a=i(611688),o=i(749473),l=i(911905),c=i(62802),h=i(588948),u=i(776734),d=i(371856);const _=(0,l.getLogger)("Linking");var m;!function(e){e[e.NotBound=0]="NotBound",e[e.BoundToWidget=1]="BoundToWidget",e[e.BoundToModel=2]="BoundToModel"}(m||(m={}));const S=new class{constructor(){this._watchedSymbol=new(n()),this._seriesShortSymbol=new(n()),this._proSymbol=new(n()),this._watchedInterval=new(n()),this._watchedIntraday=new(n()),this._watchedSeconds=new(n()),this._watchedTicks=new(n()),this._watchedRange=new(n()),this._watchedSupportedResolutions=new(n()),this._watchedSupportedChartStyles=new(n())([]),this._symbolNamesList=new(n()),this._chartWidgetBindingState=m.NotBound,this._activeChartWidget=null,this._watchedSymbolListenerBound=this._watchedSymbolListener.bind(this),this._watchedIntervalListenerBound=this._watchedIntervalListener.bind(this),this._onSymbolLinkBound=this._onSymbolLink.bind(this),this._searchCharts=null,this._searchChartsLoadDebounced=null,this._selfEmit=!1,this._preventFeedBySymbol=!1,this._feedBySymbolDebounceCounter=0}get symbol(){return this._watchedSymbol}get proSymbol(){return this._proSymbol}get symbolNamesList(){return this._symbolNamesList}get seriesShortSymbol(){return this._seriesShortSymbol.readonly()}get interval(){return this._watchedInterval}get intraday(){return this._watchedIntraday.readonly()}get seconds(){return this._watchedSeconds.readonly()}get ticks(){return this._watchedTicks.readonly()}get range(){return this._watchedRange.readonly()}get supportedResolutions(){return this._watchedSupportedResolutions.readonly()}get supportedChartStyles(){return this._watchedSupportedChartStyles.readonly()}get preventFeedBySymbol(){return this._preventFeedBySymbol}bindToChartWidget(e){if(this.unbindFromChartWidget(),this._activeChartWidget=e,e.hasModel())return void this._onChartModelCreated(e.model());e.modelCreated().subscribe(this,this._onChartModelCreated),this._chartWidgetBindingState=m.BoundToWidget;const t=e.properties().childs().mainSeriesProperties.childs();this._watchedSymbol.setValue(t.symbol.value()),this._watchedInterval.setValue(t.interval.value())}unbindFromChartWidget(){switch(this._chartWidgetBindingState){case m.BoundToWidget:if(!this._activeChartWidget)throw new Error("ChartWidget is undefined");this._activeChartWidget.modelCreated().unsubscribe(this,this._onChartModelCreated);break;case m.BoundToModel:this._symbolProperty().unsubscribe(this,this._onSymbolPropertyChange),this._watchedSymbol.unsubscribe(this._watchedSymbolListenerBound),this._mainSeries().dataEvents().symbolResolved().unsubscribe(this,this._updateSeriesSymbolInfo),this._mainSeries().dataEvents().symbolError().unsubscribe(this,this._updateSeriesSymbolInfo),this._intervalProperty().unsubscribe(this,this._onIntervalPropertyChange),this._watchedInterval.unsubscribe(this._watchedIntervalListenerBound),delete this._watchedSymbol.hook,delete this._watchedSymbol.writeLock}this._activeChartWidget=null,this._chartWidgetBindingState=m.NotBound}getChartWidget(){
return this._activeChartWidget}bindToChartWidgetCollection(e){this._chartWidgetCollection=e,this.unbindFromChartWidget(),e.activeChartWidget.subscribe(e=>{this.unbindFromChartWidget(),this.bindToChartWidget(e)},{callWithLast:!0})}bindToSearchCharts(e){this.unbindFromSearchCharts(),this._searchCharts=e,e.onSearchBySymbol.subscribe(this,this._onSearchBySymbol),e.loadingSymbol.subscribe(e=>{!1===e&&(this._feedBySymbolDebounceCounter=0)}),this._watchedSymbol.subscribe(this._onSymbolLinkBound)}unbindFromSearchCharts(){this._searchCharts&&(this._searchCharts.onSearchBySymbol.unsubscribe(this,this._onSearchBySymbol),this._watchedSymbol.unsubscribe(this._onSymbolLinkBound),this._searchCharts=null)}setPreventFeedBySymbol(e){this._preventFeedBySymbol=e}_onSearchBySymbol(e){if(!e.resolved_symbol)throw new Error("no resolved_symbol");this._selfEmit=!0,this._watchedSymbol.setValue(e.resolved_symbol),this._selfEmit=!1}_onSymbolLink(e){if(!this._selfEmit){if(!this._searchCharts){const e="No search charts defined";throw _.logError(e),new Error(e)}this._preventFeedBySymbol||this._loadSearchCharts(e)}}_loadSearchCharts(e){if(!this._searchCharts){const e="No search charts defined";throw _.logError(e),new Error(e)}if(this._searchChartsLoadDebounced)return void(this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced(e)));const t=e=>this._searchCharts?(!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,r.default)(t,2e3),this._searchChartsLoadDebounced(e)):this._searchChartsLoadDebounced=null,this._searchCharts.feedBySymbol.call(this._searchCharts,e)):()=>{};!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,r.default)(t,2e3),this._searchChartsLoadDebounced(e)):this._searchCharts.feedBySymbol(e)}_mainSeries(){if(!this._activeChartWidget)throw new Error("ChartWidget is undefined");return this._activeChartWidget.model().mainSeries()}_properties(){return this._mainSeries().properties()}_symbolProperty(){return this._properties().symbol}_intervalProperty(){return this._properties().interval}_watchedSymbolListener(e){this._symbolProperty().value()!==e&&(this._chartWidgetCollection.setSymbol(e),this._sendSnowplowAnalytics())}_sendSnowplowAnalytics(){if(window.user.do_not_track)return;const e=this._mainSeries(),t=()=>{e.dataEvents().symbolResolved().unsubscribe(this,i)},i=i=>{(0,u.getTracker)().then(e=>{if(null===e)return;const t=this._chartWidgetCollection.layout.value(),r=this._chartWidgetCollection.metaInfo.uid.value()||"";e.trackChartSymbols(i.pro_name,i.type,t,r)}),e.dataEvents().symbolError().unsubscribe(this,t)};e.dataEvents().symbolResolved().subscribe(this,i,!0),e.dataEvents().symbolError().subscribe(this,t,!0)}_onSymbolPropertyChange(){const e=this._symbolProperty().value()!==this._watchedSymbol.value();this._watchedSymbol.setValue(this._symbolProperty().value()),
e&&this._chartWidgetCollection.setSymbol(this._symbolProperty().value())}_onSymbolResolved(e){const t=this._mainSeries().symbolInfo();t&&this._applyValuesFromSymbolInfo(t)}_applyValuesFromSymbolInfo(e){const t=e.pro_name||a.enabled("trading_terminal")&&(e.full_name||e.name)||"";this._proSymbol.setValue(t),e.aliases&&this._symbolNamesList.setValue(e.aliases)}_updateSeriesSymbolInfo(){this._seriesShortSymbol.setValue(this._properties().shortName.value());const e=this._mainSeries().symbolInfo();if(e){this._applyValuesFromSymbolInfo(e);let t=(0,d.allChartStyles)();(0,o.isCloseBasedSymbol)(e)&&(t=t.filter(e=>(0,o.isSingleValueBasedStyle)(e))),this._watchedSupportedChartStyles.setValue(t),this._watchedIntraday.setValue(!!e.has_intraday),this._watchedSeconds.setValue(!!e.has_seconds),this._watchedTicks.setValue(!(0,o.isCloseBasedSymbol)(e)&&!!e.has_ticks),this._watchedRange.setValue(!(0,o.isCloseBasedSymbol)(e))}else this._watchedIntraday.deleteValue(),this._watchedSeconds.deleteValue(),this._watchedTicks.deleteValue(),this._watchedRange.deleteValue(),this._proSymbol.deleteValue()}_watchedIntervalListener(e){this._intervalProperty().value()!==e&&this._chartWidgetCollection.setResolution(e)}_onIntervalPropertyChange(){const e=this._intervalProperty().value()!==this._watchedInterval.value();this._watchedInterval.setValue(this._intervalProperty().value()),e&&this._chartWidgetCollection.setResolution(this._intervalProperty().value())}_onChartModelCreated(e){if(!this._activeChartWidget)throw new Error("ChartWidget is undefined");this._chartWidgetBindingState=m.BoundToModel,this._activeChartWidget.modelCreated().unsubscribe(this,this._onChartModelCreated);const t=this._symbolProperty();t.subscribe(this,this._onSymbolPropertyChange),this._watchedSymbol.setValue(t.value()),this._watchedSymbol.subscribe(this._watchedSymbolListenerBound);const i=this._mainSeries();i.dataEvents().symbolResolved().subscribe(this,this._onSymbolResolved),this._watchedSymbol.hook=e=>(i.symbolSameAsCurrent(e)&&(e=i.symbol()),e),i.dataEvents().symbolResolved().subscribe(this,this._updateSeriesSymbolInfo),i.dataEvents().symbolError().subscribe(this,this._updateSeriesSymbolInfo),i.dataEvents().symbolNotPermitted().subscribe(this,this._updateSeriesSymbolInfo),i.dataEvents().symbolGroupNotPermitted().subscribe(this,this._updateSeriesSymbolInfo),this._updateSeriesSymbolInfo();const r=this._intervalProperty();r.subscribe(this,this._onIntervalPropertyChange),this._watchedInterval.setValue(r.value()),this._watchedInterval.subscribe(this._watchedIntervalListenerBound),this._activeChartWidget.readOnly()&&(this._watchedSymbol.writeLock=!0)}};{const e=(0,h.getFreshInitData)().symbolInfo,t=e?e.pro_symbol:c.getValue("editchart.model.symbol",window.DEFAULT_SYMBOL);S.symbol.setValue(t)}window.TradingViewApi||(window.TradingViewApi={linking:S})}}]);